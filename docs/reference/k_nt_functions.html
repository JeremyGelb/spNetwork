<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Network k and g functions for spatio-temporal data (not ready) — k_nt_functions • spNetwork</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Network k and g functions for spatio-temporal data (not ready) — k_nt_functions"><meta property="og:description" content="Calculate the k and g functions for a set of points on a
  network and in time (not ready)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spNetwork</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Isochrones.html">Calculating isochrones</a>
    </li>
    <li>
      <a href="../articles/KNetworkFunctions.html">Network k Functions</a>
    </li>
    <li>
      <a href="../articles/NetworkBuilding.html">Building graphs</a>
    </li>
    <li>
      <a href="../articles/NKDE.html">Network Kernel Density Estimate</a>
    </li>
    <li>
      <a href="../articles/NKDEdetailed.html">Details about NKDE</a>
    </li>
    <li>
      <a href="../articles/SpatialWeightMatrices.html">Spatial Weight Matrices</a>
    </li>
    <li>
      <a href="../articles/TNKDE.html">Temporal Network Kernel Density Estimate</a>
    </li>
    <li>
      <a href="../articles/web_vignettes/AdaptiveBW.html">K-nearest neighbour adaptive bandwidth</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JeremyGelb/spNetwork/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Network k and g functions for spatio-temporal data (not ready)</h1>
    <small class="dont-index">Source: <a href="https://github.com/JeremyGelb/spNetwork/blob/HEAD/R/k_functions_nettime_sf.R" class="external-link"><code>R/k_functions_nettime_sf.R</code></a></small>
    <div class="hidden name"><code>k_nt_functions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the k and g functions for a set of points on a
  network and in time (not ready).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">k_nt_functions</span><span class="op">(</span>
  <span class="va">lines</span>,
  <span class="va">points</span>,
  <span class="va">points_time</span>,
  <span class="va">start_net</span>,
  <span class="va">end_net</span>,
  <span class="va">step_net</span>,
  <span class="va">width_net</span>,
  <span class="va">start_time</span>,
  <span class="va">end_time</span>,
  <span class="va">step_time</span>,
  <span class="va">width_time</span>,
  <span class="va">nsim</span>,
  conf_int <span class="op">=</span> <span class="fl">0.05</span>,
  digits <span class="op">=</span> <span class="fl">2</span>,
  tol <span class="op">=</span> <span class="fl">0.1</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  agg <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>lines</dt>
<dd><p>A feature collection of linestrings representing the underlying network. The
geometries must be simple Linestrings (may crash if some geometries
 are invalid) without MultiLineSring</p></dd>
<dt>points</dt>
<dd><p>A feature collection of points representing the points on the
network. These points will be snapped on their nearest line</p></dd>
<dt>points_time</dt>
<dd><p>A numeric vector indicating when the point occured</p></dd>
<dt>start_net</dt>
<dd><p>A double, the lowest network distance used to evaluate the k and g functions</p></dd>
<dt>end_net</dt>
<dd><p>A double, the highest network distance used to evaluate  the k and g functions</p></dd>
<dt>step_net</dt>
<dd><p>A double, the step between two evaluations of the k and g for the network distance
function. start_net, end_net and step_net are used to create a vector of distances with the function seq</p></dd>
<dt>width_net</dt>
<dd><p>The width (network distance) of each donut for the g-function. Half of the width is applied on
both sides of the considered distance</p></dd>
<dt>start_time</dt>
<dd><p>A double, the lowest time distance used to evaluate the k and g functions</p></dd>
<dt>end_time</dt>
<dd><p>A double, the highest time distance used to evaluate  the k and g functions</p></dd>
<dt>step_time</dt>
<dd><p>A double, the step between two evaluations of the k and g for the time distance
function. start_time, end_time and step_time are used to create a vector of distances with the function seq</p></dd>
<dt>width_time</dt>
<dd><p>The width (time distance) of each donut for the g-function. Half of the width is applied on
both sides of the considered distance</p></dd>
<dt>nsim</dt>
<dd><p>An integer indicating the number of Monte Carlo simulations
to perform for inference</p></dd>
<dt>conf_int</dt>
<dd><p>A double indicating the width confidence interval (default =
0.05) calculated on the Monte Carlo simulations</p></dd>
<dt>digits</dt>
<dd><p>An integer indicating the number of digits to retain from the
spatial coordinates</p></dd>
<dt>tol</dt>
<dd><p>When adding the points to the network, specify the minimum
distance between these points and the lines' extremities. When points are
closer, they are added at the extremity of the lines</p></dd>
<dt>resolution</dt>
<dd><p>When simulating random points on the network, selecting a
resolution will reduce greatly the calculation time. When resolution is null
the random points can occur everywhere on the graph. If a value is specified,
the edges are split according to this value and the random points can only be
vertices on the new network</p></dd>
<dt>agg</dt>
<dd><p>A double indicating if the events must be aggregated within a distance.
If NULL, the events are aggregated only by rounding the coordinates</p></dd>
<dt>verbose</dt>
<dd><p>A Boolean indicating if progress messages should be displayed</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following values : <br></p><ul><li><p>obs_k A matrix with the observed k-values</p></li>
<li><p>lower_k A matrix with the lower bounds of the simulated k-values</p></li>
<li><p>upper_k A matrix with the upper bounds of the simulated k-values</p></li>
<li><p>obs_g A matrix with the observed g-values</p></li>
<li><p>lower_g A matrix with the lower bounds of the simulated g-values</p></li>
<li><p>upper_g A matrix with the upper bounds of the simulated g-values</p></li>
<li><p>distances_net A vector with the used network distances</p></li>
<li><p>distances_time A vector with the used time distances</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The k-function is a method to characterize the dispersion of a set
  of points. For each point, the numbers of other points in subsequent radii
  are calculated in both space and time. This empirical k-function can be more or less clustered
  than a k-function obtained if the points were randomly located . In
  a network, the network distance is used instead of the Euclidean distance.
  This function uses Monte Carlo simulations to assess if the points are
  clustered or dispersed. The function also calculates the
  g-function, a modified version of the k-function using rings instead of
  disks. The width of the ring must be chosen. The main interest is to avoid
  the cumulative effect of the classical k-function. This function is maturing,
  it works as expected (unit tests) but will probably be modified in the
  future releases (gain speed, advanced features, etc.).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># \donttest{</span>
<span class="va">eventsgpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"events.gpkg"</span>, package <span class="op">=</span> <span class="st">"spNetwork"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bike_accidents</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">eventsgpkg</span>,layer<span class="op">=</span><span class="st">"bike_accidents"</span><span class="op">)</span>
<span class="va">networkgpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"networks.gpkg"</span>, package <span class="op">=</span> <span class="st">"spNetwork"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mtl_network</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">networkgpkg</span>,layer<span class="op">=</span><span class="st">"mtl_network"</span><span class="op">)</span>

<span class="co"># converting the Date field to a numeric field (counting days)</span>
<span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">bike_accidents</span><span class="op">$</span><span class="va">Date</span>, format <span class="op">=</span> <span class="st">"%Y/%m/%d"</span><span class="op">)</span>
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016/01/01"</span>, format <span class="op">=</span> <span class="st">"%Y/%m/%d"</span><span class="op">)</span>
<span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span>, <span class="va">start</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span>
<span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>

<span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">k_nt_functions</span><span class="op">(</span>
      lines <span class="op">=</span>  <span class="va">mtl_network</span>,
      points <span class="op">=</span> <span class="va">bike_accidents</span>,
      points_time <span class="op">=</span> <span class="va">bike_accidents</span><span class="op">$</span><span class="va">Time</span>,
      start_net <span class="op">=</span> <span class="fl">0</span> ,
      end_net <span class="op">=</span> <span class="fl">2000</span>,
      step_net <span class="op">=</span> <span class="fl">10</span>,
      width_net <span class="op">=</span> <span class="fl">200</span>,
      start_time <span class="op">=</span> <span class="fl">0</span>,
      end_time <span class="op">=</span> <span class="fl">360</span>,
      step_time <span class="op">=</span> <span class="fl">7</span>,
      width_time <span class="op">=</span> <span class="fl">14</span>,
      nsim <span class="op">=</span> <span class="fl">50</span>,
      conf_int <span class="op">=</span> <span class="fl">0.05</span>,
      digits <span class="op">=</span> <span class="fl">2</span>,
      tol <span class="op">=</span> <span class="fl">0.1</span>,
      resolution <span class="op">=</span> <span class="cn">NULL</span>,
      agg <span class="op">=</span> <span class="fl">15</span>,
      verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># }</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Gelb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

