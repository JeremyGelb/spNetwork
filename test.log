✔ | F W S  OK | Context
⠏ |         0 | adaptive_bw_sf                                                ⠏ |         0 | testing functions for adptative bandwidth in NKDE             [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "    quadra 1/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 2/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 3/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "Splitting the data with the spatial grid ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 2/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 3/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠋ |         1 | testing functions for adptative bandwidth in NKDE             [1] "precalculated bws : 3.73661539510889;2.93822642599985;2.45923541821083"
[1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "calculating the local bandwidth ..."
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "starting the kernel calculations ..."
[1] "starting the kernel calculations ..."
[1] "combining the results ..."
⠙ |         2 | testing functions for adptative bandwidth in NKDE             [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "    quadra 1/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 2/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 3/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "Splitting the data with the spatial grid ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 2/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 3/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠹ |         3 | testing functions for adptative bandwidth in NKDE             ✔ |         3 | testing functions for adptative bandwidth in NKDE [2.1s]
⠏ |         0 | adaptive_bw_tnkde_interaction_sf                              ⠏ |         0 | testing functions for adptative bandwidth with interaction in TNKDE[1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠋ |         1 | testing functions for adptative bandwidth with interaction in TNKDE[1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "starting the kernel calculations ..."
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠙ |         2 | testing functions for adptative bandwidth with interaction in TNKDE[1] "start calculating the kernel values for the adaptive bandwidth..."
⠹ |         3 | testing functions for adptative bandwidth with interaction in TNKDE[1] "start calculating the kernel values for the adaptive bandwidth..."
⠦ |         7 | testing functions for adptative bandwidth with interaction in TNKDE✔ |         8 | testing functions for adptative bandwidth with interaction in TNKDE [1.4s]
⠏ |         0 | base_kernels_sf                                               ⠏ |         0 | testing the base kernel implemented                           ✔ |         2 | testing the base kernel implemented
⠏ |         0 | basics_listw_sf                                               ⠏ |         0 | basic tests for the neighbour matrices creation               [1] "generating the starting points"
[1] "snapping the points to the lines (only once)"
[1] "starting the network part"
[1] "working on quadra : 1/1"
[1] "adding the points as vertices to nearest lines"
[1] "splitting the lines for the network"
[1] "generating the network"
[1] "calculating the distances on the network"
[1] "building the final listw object"
[1] "finally generating the listw object ..."
⠙ |         2 | basic tests for the neighbour matrices creation               ✔ |         2 | basic tests for the neighbour matrices creation [0.5s]
⠏ |         0 | border_correction_sf                                          ⠏ |         0 | testing function used to apply border correction in NKDE      ⠋ |         1 | testing function used to apply border correction in NKDE      ⠙ |         2 | testing function used to apply border correction in NKDE      ⠹ |         3 | testing function used to apply border correction in NKDE      ⠸ |         4 | testing function used to apply border correction in NKDE      ✔ |         4 | testing function used to apply border correction in NKDE [1.5s]
⠏ |         0 | bw_selection_sf                                               ⠏ |         0 | testing the bandwidth selection functions                     ⠙ |         2 | testing the bandwidth selection functions                     ⠸ |         4 | testing the bandwidth selection functions                     [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "Splittig the dataset within the grid ..."
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%⠴ |         6 | testing the bandwidth selection functions                     ⠦ |         7 | testing the bandwidth selection functions                     [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%⠇ | 1       8 | testing the bandwidth selection functions                        bw   cvl_scores
1 200 3.068423e+12
2 300 9.065686e+12
3 400 1.812569e+13
   bw   cvl_scores
1 200 3.068423e+12
2 300 9.065686e+12
3 400 1.812569e+13
   bw   cvl_scores
1 200 3.068423e+12
2 300 9.065686e+12
3 400 1.812569e+13
⠏ | 1       9 | testing the bandwidth selection functions                     [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "start calculating the kernel values for the adaptive bandwidth..."
[1] "    quadra 1/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 2/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "    quadra 3/3"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "Splittig the dataset within the grid ..."
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |=======================                                             |  33%  |                                                                            |=============================================                       |  67%  |                                                                            |====================================================================| 100%⠋ | 1      10 | testing the bandwidth selection functions                     ⠙ | 1      11 | testing the bandwidth selection functions                     ✖ | 1      11 | testing the bandwidth selection functions [5.0s]
──────────────────────────────────────────────────────────────────────────────
Error ('test_bw_selection_sf.R:502:3'): Testing that bw selection by cv-likelihood gives the same score in single and multicore
Error in `bw_checks(check, lines, samples, events, kernel_name, method, 
    bws_net = bws, bws_time = NULL, adaptive = adaptive, trim_net_bws = trim_bws, 
    diggle_correction = diggle_correction, study_area = study_area)`: trim_net_bws and trim_time_bws must both be NULL if adaptive = FALSE
Backtrace:
 1. spNetwork::bw_cv_likelihood_calc.mc(...)
      at test_bw_selection_sf.R:502:2
 2. spNetwork:::bw_checks(...)
      at spNetwork/R/bandwidth_selection_cv_sf.R:523:2
──────────────────────────────────────────────────────────────────────────────
⠏ |         0 | bw_selection_tnkde_sf                                         ⠏ |         0 | testing the bandwidth selection functions for tnkde           ⠋ |         1 | testing the bandwidth selection functions for tnkde           ⠙ |         2 | testing the bandwidth selection functions for tnkde           [1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%[1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%⠸ |         4 | testing the bandwidth selection functions for tnkde           [1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "start calculating the CV values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%[1] "prior data preparation ..."
[1] "Calculating the correction factor if required"
[1] "splitting the data by the grid..."
[1] "start calculating the CV values ..."
⠼ |         5 | testing the bandwidth selection functions for tnkde           ⠴ |         6 | testing the bandwidth selection functions for tnkde           ⠦ |         7 | testing the bandwidth selection functions for tnkde           ⠧ |         8 | testing the bandwidth selection functions for tnkde           ✔ |         8 | testing the bandwidth selection functions for tnkde [1.8s]
⠏ |         0 | geometrical_functions_sf                                      ⠏ |         0 | Testing the geometrical functions of the package                |                                                                            |                                                                    |   0%  |                                                                            |==============                                                      |  20%  |                                                                            |===========================                                         |  40%  |                                                                            |=========================================                           |  60%  |                                                                            |======================================================              |  80%  |                                                                            |====================================================================| 100%⠼ |         5 | Testing the geometrical functions of the package              ⠏ |        10 | Testing the geometrical functions of the package              ⠋ |        11 | Testing the geometrical functions of the package                |                                                                            |                                                                    |   0%  |                                                                            |=================                                                   |  25%  |                                                                            |==================================                                  |  50%  |                                                                            |===================================================                 |  75%  |                                                                            |====================================================================| 100%✔ |        12 | Testing the geometrical functions of the package [0.4s]
⠏ |         0 | graph_functions_sf                                            ⠏ |         0 | testing the graph functions                                   ✔ |         2 | testing the graph functions
⠏ |         0 | isochrone_sf                                                  ⠏ |         0 | testing the isochrone creation functions                      ⠋ |         1 | testing the isochrone creation functions                      ⠙ |         2 | testing the isochrone creation functions                      ✔ |         2 | testing the isochrone creation functions [0.3s]
⠏ |         0 | testing the isochrone creation functions                      ✔ |         1 | testing the isochrone creation functions
⠏ |         0 | k_functions_sf                                                ⠏ |         0 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
  |                                                                            |                                                                    |   0%  |                                                                            |==============                                                      |  20%  |                                                                            |===========================                                         |  40%  |                                                                            |=========================================                           |  60%  |                                                                            |======================================================              |  80%  |                                                                            |====================================================================| 100%⠋ |   1     0 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
  |                                                                            |                                                                    |   0%  |                                                                            |==============                                                      |  20%  |                                                                            |===========================                                         |  40%  |                                                                            |=========================================                           |  60%  |                                                                            |======================================================              |  80%  |                                                                            |====================================================================| 100%⠹ |   1     2 | testing functions for k and g function analysis               ⠼ |   1     4 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
⠴ |   2     4 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
⠧ |   3     5 | testing functions for k and g function analysis               ⠇ |   3     6 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
  |                                                                            |                                                                    |   0%⠏ |   4     6 | testing functions for k and g function analysis               [1] "Preparing data ..."
[1] "Snapping points on lines ..."
[1] "Building graph ..."
[1] "Calculating k and g functions ..."
[1] "Calculating the simulations ..."
  |                                                                            |                                                                    |   0%  |                                                                            |==============                                                      |  20%  |                                                                            |===========================                                         |  40%  |                                                                            |=========================================                           |  60%  |                                                                            |======================================================              |  80%  |                                                                            |====================================================================| 100%⠙ |   4     8 | testing functions for k and g function analysis               ✔ |   4     8 | testing functions for k and g function analysis [1.8s]
──────────────────────────────────────────────────────────────────────────────
Warning ('test_k_functions_sf.R:28:3'): Testing the simple k function
`aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.
Backtrace:
 1. spNetwork::kfunctions(...)
      at test_k_functions_sf.R:28:2
 4. ggplot2::aes_string(x = "distances", ymin = "lower_k", ymax = "upper_k")
 5. ggplot2:::deprecate_soft0(...)

Warning ('test_k_functions_sf.R:332:3'): Testing the multicore simple k function
UNRELIABLE VALUE: One of the ‘future.apply’ iterations (‘future_lapply-1’) unexpectedly generated random numbers without declaring so. There is a risk that those random numbers are not statistically sound and the overall results might be invalid. To fix this, specify 'future.seed=TRUE'. This ensures that proper, parallel-safe random numbers are produced via the L'Ecuyer-CMRG method. To disable this check, use 'future.seed = NULL', or set option 'future.rng.onMisuse' to "ignore".
Backtrace:
 1. spNetwork::kfunctions.mc(...)
      at test_k_functions_sf.R:332:2
 2. progressr::with_progress(...)
      at spNetwork/R/k_functions_sf.R:594:6
 3. progressr:::flush_conditions(conditions)
      at spNetwork/R/k_functions_sf.R:594:6

Warning ('test_k_functions_sf.R:368:3'): Testing the multicore cross k function
UNRELIABLE VALUE: One of the ‘future.apply’ iterations (‘future_lapply-1’) unexpectedly generated random numbers without declaring so. There is a risk that those random numbers are not statistically sound and the overall results might be invalid. To fix this, specify 'future.seed=TRUE'. This ensures that proper, parallel-safe random numbers are produced via the L'Ecuyer-CMRG method. To disable this check, use 'future.seed = NULL', or set option 'future.rng.onMisuse' to "ignore".
Backtrace:
 1. spNetwork::cross_kfunctions.mc(...)
      at test_k_functions_sf.R:368:2
 2. progressr::with_progress(...)
      at spNetwork/R/k_functions_sf.R:1072:4
 3. progressr:::flush_conditions(conditions)
      at spNetwork/R/k_functions_sf.R:1072:4

Warning ('test_k_functions_sf.R:407:3'): Testing the simple k function in space-time
UNRELIABLE VALUE: One of the ‘future.apply’ iterations (‘future_lapply-1’) unexpectedly generated random numbers without declaring so. There is a risk that those random numbers are not statistically sound and the overall results might be invalid. To fix this, specify 'future.seed=TRUE'. This ensures that proper, parallel-safe random numbers are produced via the L'Ecuyer-CMRG method. To disable this check, use 'future.seed = NULL', or set option 'future.rng.onMisuse' to "ignore".
Backtrace:
 1. spNetwork::k_nt_functions.mc(...)
      at test_k_functions_sf.R:407:2
 2. progressr::with_progress(...)
      at spNetwork/R/k_functions_nettime_sf.R:449:6
 3. progressr:::flush_conditions(conditions)
      at spNetwork/R/k_functions_nettime_sf.R:449:6
──────────────────────────────────────────────────────────────────────────────
⠏ |         0 | kernels                                                       ⠏ |         0 | testing the kernel functions                                  [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "Splitting the data with the spatial grid ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%[1] "combining the results ..."
⠙ |         2 | testing the kernel functions                                  ⠸ |         4 | testing the kernel functions                                  ⠼ |         5 | testing the kernel functions                                  ⠴ |         6 | testing the kernel functions                                  ✔ |         6 | testing the kernel functions [0.8s]
⠏ |         0 | knn_sf                                                        ⠏ |         0 | testing the knn functions                                     ⠙ |         2 | testing the knn functions                                     ⠸ |         4 | testing the knn functions                                     ⠼ |         5 | testing the knn functions                                     ✔ |         5 | testing the knn functions [0.5s]
⠏ |         0 | listw_symetry_sf                                              ⠏ |         0 | symetry and comparison between simple and multicore           ⠋ |   1     0 | symetry and comparison between simple and multicore           ⠙ |   2     0 | symetry and comparison between simple and multicore           ✔ |   2     1 | symetry and comparison between simple and multicore [7.3s]
──────────────────────────────────────────────────────────────────────────────
Warning ('test_listw_symetry_sf.R:8:3'): A listw object returned by the function network_listw must be symetric and identic as one returned by network_listw.mc
zero sum general weights
Backtrace:
 1. spNetwork::network_listw(...)
      at test_listw_symetry_sf.R:8:2
 2. spdep::nb2listw(...)
      at spNetwork/R/neighbouring_sf.R:425:6

Warning ('test_listw_symetry_sf.R:23:3'): A listw object returned by the function network_listw must be symetric and identic as one returned by network_listw.mc
zero sum general weights
Backtrace:
 1. spNetwork::network_listw.mc(...)
      at test_listw_symetry_sf.R:23:2
 2. spdep::nb2listw(...)
      at spNetwork/R/neighbouring_sf.R:630:6
──────────────────────────────────────────────────────────────────────────────
⠏ |         0 | nkde_execution_functions_sf                                   ⠏ |         0 | testing function used to perform NKDE                         ✔ |         1 | testing function used to perform NKDE
⠏ |         0 | nkde_manual_bws                                               ⠏ |         0 | testing the kernel functions with manually changed bandwidths ⠙ |         2 | testing the kernel functions with manually changed bandwidths ✔ |         2 | testing the kernel functions with manually changed bandwidths [0.2s]
⠏ |         0 | spatial_indexing                                              ⠏ |         0 | testing the spatial indexing functions                        ✔ |         1 | testing the spatial indexing functions
⠏ |         0 | splitting_functions                                           ⠏ |         0 | testing the base kernel implemented                           ⠋ |         1 | testing the base kernel implemented                           ⠙ |         2 | testing the base kernel implemented                           ✔ |         2 | testing the base kernel implemented [0.9s]
⠏ |         0 | tnkde_sf                                                      ⠏ |         0 | testing the kernel functions                                  [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
  |                                                                            |                                                                    |   0%  |                                                                            |====================================================================| 100%[1] "combining the results ..."
⠋ |         1 | testing the kernel functions                                  [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠙ |         2 | testing the kernel functions                                  [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠹ |         3 | testing the kernel functions                                  [1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "start calculating the kernel values ..."
[1] "    quadra 1/1"
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
[1] "checking inputs ..."
[1] "prior data preparation ..."
[1] "starting the kernel calculations ..."
[1] "    build graph ..."
[1] "        calculating NKDE values ..."
[1] "combining the results ..."
⠸ |         4 | testing the kernel functions                                  ✔ |         4 | testing the kernel functions [0.8s]

══ Results ═══════════════════════════════════════════════════════════════════
Duration: 25.8 s

[ FAIL 1 | WARN 6 | SKIP 0 | PASS 85 ]
